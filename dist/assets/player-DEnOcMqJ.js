import{u as $e,a as Ie,g as Pe,D as Be,G as Fe,d as Ue,H as Re,c as pe,o as Ae,a0 as N,B as V,r as _,w as Ke,I as Y,J as p,K as Se,f as u,i as T,l as a,m as e,j as s,n as m,p as d,t as i,q as f,F as Z,x as ee,y as te,a8 as Te,s as me,a4 as qe,$ as Me,A as ge}from"./index-CnGsCQVR.js";import{g as _e}from"./tools-CmP39zM0.js";const Ee={class:"page-div"},je={class:"card-header"},He={class:"card-header"},Ge={style:{"margin-top":"20px"}},We={class:"card-header"},Je={style:{"margin-top":"20px"}},Oe={class:"card-header"},Qe={style:{"margin-top":"20px"}},Xe={class:"card-header"},Ye={class:"fcc"},Ze={class:"el-upload__text"},et={class:"el-upload__tip"},tt=Me({name:"settingsPlayer"}),nt=Object.assign(tt,{setup(lt){const{t:o}=$e();Ie();const k=Pe(),P=Be();Fe();const le=Ue(),ae=Re("refresh"),L=pe(()=>k.isDark),y=pe(()=>k.language);Ae(()=>{w()});const w=(n=!1)=>{N.player.list.get({clusterName:k.selectedDstCluster}).then(l=>{var c,r,g;if(q.value=l.data.players,M.value=l.data.uidMap,B.value=[],(((c=l.data.adminList)==null?void 0:c.length)||0)>0)for(let v of l.data.adminList)v!==""&&B.value.push(v);if(F.value=[],(((r=l.data.blockList)==null?void 0:r.length)||0)>0)for(let v of l.data.blockList)v!==""&&F.value.push(v);if(U.value=[],(((g=l.data.whiteList)==null?void 0:g.length)||0)>0)for(let v of l.data.whiteList)v!==""&&U.value.push(v);if(n){let v;y.value==="zh"?v="刷新成功":v="Refresh Success",V(v)}})},se=_("players"),q=_([]),M=_({}),B=_([]),F=_([]),U=_([]),E=n=>{for(let l of B.value)if(l===n)return!0},ne=n=>{for(let l of F.value)if(l===n)return!0},oe=n=>{for(let l of U.value)if(l===n)return!0},ie=n=>{switch(n.type){case"admin":C(n.type,"add",n.uid);break;case"block":C(n.type,"add",n.uid);break;case"white":C(n.type,"add",n.uid);break;case"kick":R(n.type,n.uid);break;case"kill":R(n.type,n.uid);break;case"respawn":R(n.type,n.uid);break;case"despawn":R(n.type,n.uid);break}},C=(n,l,c)=>{const r={clusterName:k.selectedDstCluster,listName:n,type:l,uid:c};N.player.change.post(r).then(g=>{V(g.message),w()})},R=(n,l)=>{const c={clusterName:k.selectedDstCluster,uid:l,type:n};N.player.action.post(c).then(r=>{V(r.message)})},j=n=>n in M.value?" ["+M.value[n]+"]":y.value==="zh"?" [暂未获取到]":" [Not yet obtained]",ve=(n,l)=>{D.value=!1,h.value="",n.paneName==="history"&&W()},H=_([]),G=_(!1),W=(n=!1)=>{G.value=!0,H.value=[];const l={clusterName:k.selectedDstCluster};N.player.history.get(l).then(c=>{for(let r of c.data)r.uid.length===11&&H.value.push(r);if(n){let r;y.value==="zh"?r="刷新成功":r="Refresh Success",V(r)}}).finally(()=>{G.value=!1})},J=_(),A=_(!1),x=_(!1),he=()=>{J.value&&J.value.clearFiles(),A.value=!0,x.value=!1},ye=n=>/\.xls|xlsx$/i.test(n.name)?!0:(ge(y.value==="zh"?"请上传Excel文件":"Please upload a Excel file"),!1),be=n=>{x.value=!0;const l=new FormData;l.append("file",n.file),N.player.addBlockUpload.post(l).then(c=>{w(),V(c.message)}).finally(()=>{A.value=!1,x.value=!1})},ke=()=>{setTimeout(()=>{P.meta.isKeepAlive&&le.removeKeepAliveName(P.name),ae(!1),Y(()=>{P.meta.isKeepAlive&&le.addKeepAliveName(P.name),ae(!0)})},0)},D=_(!1),K=_(),h=_(""),O=()=>{D.value=!0,Y(()=>{K.value.input.focus()})},z=n=>{if(h.value){if(!/^KU_/.test(h.value)){ge(y.value==="zh"?"请输入正确的玩家UID":"Please enter the correct player UID");return}C(n,"add",h.value)}D.value=!1,h.value=""};_(!1),_("");const we=()=>{const n={clusterName:k.selectedDstCluster};N.player.historyClean.post(n).then(l=>{V(l.message)}).finally(()=>{W(!1)})};return Ke(()=>k.selectedDstCluster,n=>{n&&Y(()=>{ke()})},{immediate:!1}),(n,l)=>{const c=p("el-button"),r=p("el-table-column"),g=p("el-tag"),v=p("arrow-down"),S=p("el-icon"),b=p("el-dropdown-item"),de=p("el-dropdown-menu"),ue=p("el-dropdown"),re=p("el-table"),Ce=p("el-result"),$=p("el-card"),I=p("el-tab-pane"),Q=p("el-alert"),X=p("el-input"),xe=p("el-tooltip"),Le=p("el-tabs"),De=p("el-col"),ze=p("el-row"),Ne=p("el-upload"),Ve=p("el-dialog"),ce=Se("loading");return u(),T("div",Ee,[a(ze,{gutter:10},{default:e(()=>[a(De,{lg:24,md:24,sm:24,span:24,xs:24,style:{"margin-top":"10px"}},{default:e(()=>[a(Le,{modelValue:se.value,"onUpdate:modelValue":l[14]||(l[14]=t=>se.value=t),onTabClick:ve},{default:e(()=>[a(I,{label:s(o)("setting.players"),name:"players"},{default:e(()=>[a($,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",je,[d(i(s(o)("setting.players"))+" ",1),m("div",null,[a(c,{size:"default",onClick:l[0]||(l[0]=t=>w(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[q.value?(u(),f(re,{key:0,data:q.value,"max-height":"68vh",border:"",size:"small",style:{width:"100%"}},{default:e(()=>[a(r,{label:s(o)("setting.nickName"),prop:"nickName"},null,8,["label"]),a(r,{label:s(o)("setting.role"),prop:"prefab"},{default:e(t=>[t.row.prefab===""?(u(),f(g,{key:0,type:"warning"},{default:e(()=>[d(i(s(o)("setting.roleFail")),1)]),_:1})):(u(),f(g,{key:1,type:"success"},{default:e(()=>[d(i(s(_e)(t.row.prefab,y.value)),1)]),_:2},1024))]),_:1},8,["label"]),a(r,{label:s(o)("setting.age"),prop:"age"},{default:e(t=>[t.row.age?(u(),f(g,{key:0,type:"success"},{default:e(()=>[d(i(t.row.age),1)]),_:2},1024)):(u(),f(g,{key:1,type:"warning"},{default:e(()=>[d(i(s(o)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(r,{label:"UID",prop:"uid"}),a(r,{label:s(o)("setting.button.actions"),prop:"actions"},{default:e(t=>[a(ue,{trigger:"hover",onCommand:ie},{dropdown:e(()=>[a(de,null,{default:e(()=>[a(b,{command:{type:"admin",uid:t.row.uid},disabled:E(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"block",uid:t.row.uid},disabled:ne(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"white",uid:t.row.uid},disabled:oe(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addWhite")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"kick",uid:t.row.uid},disabled:E(t.row.uid),divided:""},{default:e(()=>[d(i(s(o)("setting.kick")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"kill",uid:t.row.uid}},{default:e(()=>[d(i(s(o)("setting.kill")),1)]),_:2},1032,["command"]),a(b,{command:{type:"respawn",uid:t.row.uid}},{default:e(()=>[d(i(s(o)("setting.respawn")),1)]),_:2},1032,["command"])]),_:2},1024)]),default:e(()=>[a(c,{link:"",type:"primary"},{default:e(()=>[d(i(s(o)("setting.button.actions"))+" ",1),a(S,{class:"el-icon--right"},{default:e(()=>[a(v)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])):(u(),f(Ce,{key:1,title:s(o)("setting.noPlayersFound"),icon:"warning",style:{"margin-top":"10%"}},null,8,["title"]))]),_:1})]),_:1},8,["label"]),a(I,{label:s(o)("setting.adminList"),name:"adminList"},{default:e(()=>[a($,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",He,[d(i(s(o)("setting.adminList"))+" ",1),m("div",null,[a(c,{size:"default",onClick:l[1]||(l[1]=t=>w(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[a(Q,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(i(s(o)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",Ge,[(u(!0),T(Z,null,ee(B.value,t=>(u(),f(g,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("admin","delete",t)},{default:e(()=>[d(i(t+j(t)),1)]),_:2},1032,["effect","onClose"]))),256)),D.value?(u(),f(X,{key:0,ref_key:"InputRef",ref:K,modelValue:h.value,"onUpdate:modelValue":l[2]||(l[2]=t=>h.value=t),placeholder:s(o)("setting.uidPlaceholder"),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[3]||(l[3]=te(t=>z("admin"),["enter"])),onBlur:l[4]||(l[4]=t=>z("admin"))},null,8,["modelValue","placeholder"])):(u(),f(c,{key:1,onClick:O,style:{margin:"5px 5px 0 0"}},{default:e(()=>[d(i(y.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])]),_:1})]),_:1},8,["label"]),a(I,{label:s(o)("setting.blockList"),name:"blockList"},{default:e(()=>[a($,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",We,[d(i(s(o)("setting.blockList"))+" ",1),m("div",null,[a(c,{type:"success",onClick:he},{default:e(()=>[d(i(s(o)("setting.blockListItems.uploadButton")),1)]),_:1}),a(c,{size:"default",onClick:l[5]||(l[5]=t=>w(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[m("div",null,[a(Q,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(i(s(o)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",Je,[(u(!0),T(Z,null,ee(F.value,t=>(u(),f(g,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("block","delete",t)},{default:e(()=>[d(i(t+j(t)),1)]),_:2},1032,["effect","onClose"]))),256)),D.value?(u(),f(X,{key:0,ref_key:"InputRef",ref:K,modelValue:h.value,"onUpdate:modelValue":l[6]||(l[6]=t=>h.value=t),placeholder:s(o)("setting.uidPlaceholder"),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[7]||(l[7]=te(t=>z("block"),["enter"])),onBlur:l[8]||(l[8]=t=>z("block"))},null,8,["modelValue","placeholder"])):(u(),f(c,{key:1,onClick:O,style:{margin:"5px 5px 0 0"}},{default:e(()=>[d(i(y.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])]),_:1})]),_:1},8,["label"]),a(I,{label:s(o)("setting.whiteList"),name:"whiteList"},{default:e(()=>[a($,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",Oe,[d(i(s(o)("setting.whiteList"))+" ",1),m("div",null,[a(c,{size:"default",onClick:l[9]||(l[9]=t=>w(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[m("div",null,[a(Q,{closable:!1,effect:L.value?"light":"dark",type:"success"},{default:e(()=>[d(i(s(o)("setting.tagCloseTip")),1)]),_:1},8,["effect"]),m("div",Qe,[(u(!0),T(Z,null,ee(U.value,t=>(u(),f(g,{effect:L.value?"light":"dark",closable:"",size:"large",style:{"margin-right":"5px","margin-top":"5px"},onClose:fe=>C("white","delete",t)},{default:e(()=>[d(i(t+j(t)),1)]),_:2},1032,["effect","onClose"]))),256)),D.value?(u(),f(X,{key:0,ref_key:"InputRef",ref:K,modelValue:h.value,"onUpdate:modelValue":l[10]||(l[10]=t=>h.value=t),placeholder:s(o)("setting.uidPlaceholder"),size:"default",class:"w-32",style:{margin:"5px 5px 0 0"},onKeyup:l[11]||(l[11]=te(t=>z("white"),["enter"])),onBlur:l[12]||(l[12]=t=>z("white"))},null,8,["modelValue","placeholder"])):(u(),f(c,{key:1,onClick:O,style:{margin:"5px 5px 0 0"}},{default:e(()=>[d(i(y.value==="zh"?"+ 新增":"+ New"),1)]),_:1}))])])]),_:1})]),_:1},8,["label"]),a(I,{label:s(o)("setting.historyPlayer"),name:"history"},{default:e(()=>[a($,{style:{height:"78vh"},shadow:"never"},{header:e(()=>[m("div",Xe,[a(xe,{content:s(o)("setting.historyPlayerTip"),effect:"light",placement:"top"},{default:e(()=>[m("div",Ye,[d(i(s(o)("setting.historyPlayer"))+" ",1),a(S,null,{default:e(()=>[a(s(Te))]),_:1})])]),_:1},8,["content"]),m("div",null,[a(c,{size:"default",type:"danger",onClick:we},{default:e(()=>[d(i(s(o)("setting.historyClean")),1)]),_:1}),a(c,{size:"default",onClick:l[13]||(l[13]=t=>W(!0))},{default:e(()=>[d(i(s(o)("setting.refresh")),1)]),_:1})])])]),default:e(()=>[me((u(),f(re,{ref:"tableRef",data:H.value,"max-height":"65vh",border:""},{default:e(()=>[a(r,{label:n.$t("setting.nickName"),prop:"nickname"},null,8,["label"]),a(r,{label:n.$t("setting.role"),prop:"prefab"},{default:e(t=>[t.row.prefab?(u(),f(g,{key:0,type:"success"},{default:e(()=>[d(i(s(_e)(t.row.prefab,y.value)),1)]),_:2},1024)):(u(),f(g,{key:1,type:"warning"},{default:e(()=>[d(i(s(o)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(r,{label:n.$t("setting.age"),prop:"age",sortable:""},{default:e(t=>[t.row.age?(u(),f(g,{key:0,type:"success"},{default:e(()=>[d(i(t.row.age),1)]),_:2},1024)):(u(),f(g,{key:1,type:"warning"},{default:e(()=>[d(i(s(o)("setting.roleFail")),1)]),_:1}))]),_:1},8,["label"]),a(r,{label:"UID",prop:"uid"}),a(r,{label:n.$t("setting.button.actions"),prop:"actions"},{default:e(t=>[a(ue,{trigger:"hover",onCommand:ie},{dropdown:e(()=>[a(de,null,{default:e(()=>[a(b,{command:{type:"admin",uid:t.row.uid},disabled:E(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addAdmin")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"block",uid:t.row.uid},disabled:ne(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addBlock")),1)]),_:2},1032,["command","disabled"]),a(b,{command:{type:"white",uid:t.row.uid},disabled:oe(t.row.uid)},{default:e(()=>[d(i(s(o)("setting.addWhite")),1)]),_:2},1032,["command","disabled"])]),_:2},1024)]),default:e(()=>[a(c,{link:"",type:"primary"},{default:e(()=>[d(i(s(o)("setting.button.actions"))+" ",1),a(S,{class:"el-icon--right"},{default:e(()=>[a(v)]),_:1})]),_:1})]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[ce,G.value]])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(Ve,{modelValue:A.value,"onUpdate:modelValue":l[15]||(l[15]=t=>A.value=t),"close-on-click-modal":!x.value,"close-on-press-escape":!x.value,"show-close":!x.value,title:s(o)("setting.blockListItems.uploadButton"),width:"45%"},{default:e(()=>[me((u(),f(Ne,{ref_key:"uploadRef",ref:J,"before-upload":ye,"http-request":be,limit:1,drag:""},{tip:e(()=>[m("div",et,i(s(o)("setting.blockListItems.tips")),1)]),default:e(()=>[a(S,{class:"el-icon--upload"},{default:e(()=>[a(s(qe))]),_:1}),m("div",Ze,[d(i(s(o)("setting.import.dialog.text1"))+" ",1),m("em",null,i(s(o)("setting.import.dialog.text2")),1)])]),_:1})),[[ce,x.value]])]),_:1},8,["modelValue","close-on-click-modal","close-on-press-escape","show-close","title"])])}}});export{nt as default};
