import{_ as ye}from"./Result-gWT-ossO.js";import{ai as J,aj as B,a2 as Se,ak as M,k as z,a as l,s as O,al as oe,am as ke,R as ne,an as we,i as k,z as Ve,ao as Ie,J as E,B as _e,K as De,ap as xe,aq as R,ar as me,as as Ce,E as te,at as Pe,au as Te,e as pe,av as Re,aw as X,ax as Be,ad as re,Y as H,F as ee,ay as Ae,az as Ee,aA as Ne,aB as We,f as b,d as ze,g as Oe,u as $e,b as Ge,j as Fe,a8 as Le,a9 as He,c as ie,l as t,o as v,A as f,w as u,x as se,D as Z,v as j,t as U,G as ue,aC as Je}from"./index-D0_VvR3J.js";import Me from"./room-D8qkMKEX.js";import je from"./world-DyWJR8vj.js";import Ue from"./mod-CeA6-R_V.js";import qe from"./roomSetting-84nXOJ9p.js";import{r as q}from"./room-L8Fn_wZk.js";import{V as de,m as Ke,a as ce,b as Ye}from"./VTabs-BDSGrPgI.js";import{V as K}from"./VContainer-BdgJJao2.js";import"./VRow-T4pZZsdz.js";/* empty css              */import"./VCol-B5VJ-k2B.js";import"./VTextField-BDhl3HoB.js";import"./index-BYTG7FXw.js";import"./VInput-CQ0d1937.js";import"./index-9_CLTx8V.js";import"./VTooltip-DeNPgE8E.js";import"./VRadioGroup-BFGVeut_.js";import"./VSelectionControl-KRPi77qu.js";import"./VChip-Bl_XNOgC.js";import"./VSlider-DNia88Rt.js";import"./VNumberInput-ChTB30Zu.js";import"./VForm-ZCkSOZOI.js";import"./VSpacer-BWidqFwK.js";import"./VDialog-laDXRq-G.js";import"./dialog-transition-Bnn_UDo8.js";import"./CodeEditor-UPz5RlHd.js";import"./levelDataSetting-CiZLS63Z.js";import"./ConfirmBox-qQUgNQN6.js";import"./VAlert-Cnu_GEOX.js";import"./VMenu-gAht7neB.js";import"./VList-B7_QlUC1.js";import"./ssrBoot-CVvmSRtT.js";import"./VTimePicker-2Y0tFJ9y.js";import"./axios-B3QxYxjQ.js";const ae=Symbol.for("vuetify:v-stepper"),ve=B({color:String,disabled:{type:[Boolean,String],default:!1},prevText:{type:String,default:"$vuetify.stepper.prev"},nextText:{type:String,default:"$vuetify.stepper.next"}},"VStepperActions"),fe=J()({name:"VStepperActions",props:ve(),emits:{"click:prev":()=>!0,"click:next":()=>!0},setup(e,h){let{emit:r,slots:i}=h;const{t:n}=Se();function m(){r("click:prev")}function g(){r("click:next")}return M(()=>{const y={onClick:m},w={onClick:g};return z("div",{class:"v-stepper-actions"},[l(oe,{defaults:{VBtn:{disabled:["prev",!0].includes(e.disabled),text:n(e.prevText),variant:"text"}}},{default:()=>[i.prev?.({props:y})??l(O,y,null)]}),l(oe,{defaults:{VBtn:{color:e.color,disabled:["next",!0].includes(e.disabled),text:n(e.nextText),variant:"tonal"}}},{default:()=>[i.next?.({props:w})??l(O,w,null)]})])}),{}}}),ge=ke("v-stepper-header"),Qe=B({color:String,title:String,subtitle:String,complete:Boolean,completeIcon:{type:R,default:"$complete"},editable:Boolean,editIcon:{type:R,default:"$edit"},error:Boolean,errorIcon:{type:R,default:"$error"},icon:R,ripple:{type:[Boolean,Object],default:!0},rules:{type:Array,default:()=>[]}},"StepperItem"),Xe=B({...Qe(),...xe()},"VStepperItem"),N=J()({name:"VStepperItem",directives:{vRipple:ne},props:Xe(),emits:{"group:selected":e=>!0},setup(e,h){let{slots:r}=h;const i=we(e,ae,!0),n=k(()=>i?.value.value??e.value),m=k(()=>e.rules.every(P=>P()===!0)),g=k(()=>!e.disabled&&e.editable),y=k(()=>!e.disabled&&e.editable),w=k(()=>e.error||!m.value),_=k(()=>e.complete||e.rules.length>0&&m.value),o=k(()=>w.value?e.errorIcon:_.value?e.completeIcon:i.isSelected.value&&e.editable?e.editIcon:e.icon),d=k(()=>({canEdit:y.value,hasError:w.value,hasCompleted:_.value,title:e.title,subtitle:e.subtitle,step:n.value,value:e.value}));return M(()=>{const P=(!i||i.isSelected.value||_.value||y.value)&&!w.value&&!e.disabled,$=!!(e.title!=null||r.title),D=!!(e.subtitle!=null||r.subtitle);function S(){i?.toggle()}return Ve(z("button",{class:De(["v-stepper-item",{"v-stepper-item--complete":_.value,"v-stepper-item--disabled":e.disabled,"v-stepper-item--error":w.value},i?.selectedClass.value]),disabled:!e.editable,type:"button",onClick:S},[g.value&&Ie(!0,"v-stepper-item"),l(_e,{key:"stepper-avatar",class:"v-stepper-item__avatar",color:P?e.color:void 0,size:24},{default:()=>[r.icon?.(d.value)??(o.value?l(E,{icon:o.value},null):n.value)]}),z("div",{class:"v-stepper-item__content"},[$&&z("div",{key:"title",class:"v-stepper-item__title"},[r.title?.(d.value)??e.title]),D&&z("div",{key:"subtitle",class:"v-stepper-item__subtitle"},[r.subtitle?.(d.value)??e.subtitle]),r.default?.(d.value)])]),[[ne,e.editable&&e.ripple,null]])}),{}}}),Ze=B({...Pe(Ke(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VStepperWindow"),be=J()({name:"VStepperWindow",props:Ze(),emits:{"update:modelValue":e=>!0},setup(e,h){let{slots:r}=h;const i=me(ae,null),n=Ce(e,"modelValue"),m=k({get(){return n.value!=null||!i?n.value:i.items.value.find(g=>i.selected.value.includes(g.id))?.value},set(g){n.value=g}});return M(()=>{const g=de.filterProps(e);return l(de,te({_as:"VStepperWindow"},g,{modelValue:m.value,"onUpdate:modelValue":y=>m.value=y,class:["v-stepper-window",e.class],style:e.style,mandatory:!1,touch:!1}),r)}),{}}}),et=B({...Ye()},"VStepperWindowItem"),W=J()({name:"VStepperWindowItem",props:et(),setup(e,h){let{slots:r}=h;return M(()=>{const i=ce.filterProps(e);return l(ce,te({_as:"VStepperWindowItem"},i,{class:["v-stepper-window-item",e.class],style:e.style}),r)}),{}}}),tt=B({altLabels:Boolean,bgColor:String,completeIcon:R,editIcon:R,editable:Boolean,errorIcon:R,hideActions:Boolean,items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},nonLinear:Boolean,flat:Boolean,...We()},"Stepper"),at=B({...tt(),...Ne({mandatory:"force",selectedClass:"v-stepper-item--selected"}),...Ee(),...Ae(ve(),["prevText","nextText"])},"VStepper"),lt=J()({name:"VStepper",props:at(),emits:{"update:modelValue":e=>!0},setup(e,h){let{slots:r}=h;const{items:i,next:n,prev:m,selected:g}=Te(e,ae),{displayClasses:y,mobile:w}=pe(e),{completeIcon:_,editIcon:o,errorIcon:d,color:P,editable:$,prevText:D,nextText:S}=Re(e),A=k(()=>e.items.map((p,T)=>{const c=X(p,e.itemTitle,p),F=X(p,e.itemValue,T+1),I=e.itemProps===!0?p:X(p,e.itemProps),V={title:c,value:F,...I};return{title:V.title,value:V.value,props:V,raw:p}})),x=k(()=>i.value.findIndex(p=>g.value.includes(p.id))),G=k(()=>e.disabled?e.disabled:x.value===0?"prev":x.value===i.value.length-1?"next":!1);return Be({VStepperItem:{editable:$,errorIcon:d,completeIcon:_,editIcon:o,prevText:D,nextText:S},VStepperActions:{color:P,disabled:G,prevText:D,nextText:S}}),M(()=>{const p=re.filterProps(e),T=!!(r.header||e.items.length),c=e.items.length>0,F=!e.hideActions&&!!(c||r.actions);return l(re,te(p,{color:e.bgColor,class:["v-stepper",{"v-stepper--alt-labels":e.altLabels,"v-stepper--flat":e.flat,"v-stepper--non-linear":e.nonLinear,"v-stepper--mobile":w.value},y.value,e.class],style:e.style}),{default:()=>[T&&l(ge,{key:"stepper-header"},{default:()=>[A.value.map((I,V)=>{let{raw:Y,...L}=I;return z(ee,null,[!!V&&l(H,null,null),l(N,L.props,{default:r[`header-item.${L.value}`]??r.header,icon:r.icon,title:r.title,subtitle:r.subtitle})])})]}),c&&l(be,{key:"stepper-window"},{default:()=>[A.value.map(I=>l(W,{value:I.value},{default:()=>r[`item.${I.value}`]?.(I)??r.item?.(I)}))]}),r.default?.({prev:m,next:n}),F&&(r.actions?.({next:n,prev:m})??l(fe,{key:"stepper-actions","onClick:prev":m,"onClick:next":n},r))]})}),{prev:m,next:n}}}),$t={__name:"base",setup(e){const h=b(window.innerHeight),r=ze(),i=Oe();pe(),$e();const{t:n}=Ge(),m=b(!1),g=b(0),y=b(0),w=async()=>{if(i.room.id!==0){const a=await q.base.get({id:i.room.id});S.value=a.data.roomData,x.value=a.data.worldData,I(a.data.roomSettingData)}},_=async()=>{const a=await q.factor.get();g.value=a.data.roomCount,y.value=a.data.worldCount},o=b(0),d=()=>Math.max(2,Math.floor(h.value-304)),P=()=>{o.value--},$=async()=>{if(o.value===0&&D.value){const a=await D.value.validate();if(a.validate){S.value=a.formData,o.value++;return}}if(o.value===1&&A.value){const a=await A.value.validate();if(a.validate){x.value=a.formData,o.value++;return}}if(o.value===2&&G.value){const a=await G.value.validate();if(a.validate){p.value=a.formData,o.value++;return}}if(o.value===3&&T.value){const a=await T.value.validate();if(a.validate){c.value=a.formData,o.value++;return}}},D=b(),S=b({}),A=b(),x=b([]),G=b(),p=b(),T=b(),c=b({}),F=()=>({roomID:0,backupEnable:c.value.backup.enable,backupSetting:JSON.stringify(c.value.backup.setting),backupCleanEnable:c.value.backupClean.enable,backupCleanSetting:c.value.backupClean.setting,restartEnable:c.value.restart.enable,restartSetting:c.value.restart.setting,keepaliveEnable:c.value.keepalive.enable,keepaliveSetting:c.value.keepalive.setting,scheduledStartStopEnable:c.value.scheduledStartStop.enable,scheduledStartStopSetting:JSON.stringify(c.value.scheduledStartStop.setting),tickRate:c.value.tickRate,startType:c.value.startType,announceSetting:c.value.announceSetting}),I=a=>{c.value={backup:{enable:a.backupEnable,setting:JSON.parse(a.backupSetting)},backupClean:{enable:a.backupCleanEnable,setting:a.backupCleanSetting},restart:{enable:a.restartEnable,setting:a.restartSetting},keepalive:{enable:a.keepaliveEnable,setting:a.keepaliveSetting},scheduledStartStop:{enable:a.scheduledStartStopEnable,setting:JSON.parse(a.scheduledStartStopSetting)},tickRate:a.tickRate,startType:a.startType,announceSetting:a.announceSetting}},V=b(!1),Y=me("refresh"),L=()=>{setTimeout(()=>{Y(!1),Je(()=>{Y(!0)})},0)},he=()=>{const a={roomData:S.value,worldData:x.value,roomSettingData:F()};if(i.room.id){for(let s=0;s<a.worldData.length;s++)p.value.modInOne?(a.roomData.modInOne=!0,a.roomData.modData=p.value.modData):(a.roomData.modInOne=!1,a.worldData[s].modData=p.value.worlds[s].modData),a.worldData[s].roomID=i.room.id,delete a.worldData[s].name,delete a.worldData[s].id;a.roomSettingData.roomID=i.room.id,V.value=!0,q.base.put(a).then(s=>{ue(s.message),i.room={id:s.data.id,gameName:s.data.gameName},L()}).finally(()=>{V.value=!1})}else{for(let s=0;s<a.worldData.length;s++)p.value.modInOne?(a.roomData.modInOne=!0,a.roomData.modData=p.value.modData):(a.roomData.modInOne=!1,a.worldData[s].modData=p.value.worlds[s].modData),a.worldData[s].id=0,delete a.worldData[s].name;V.value=!0,q.base.post(a).then(s=>{ue(s.message),i.room={id:s.data.id,gameName:s.data.gameName},L()}).finally(()=>{V.value=!1})}},le=Le(()=>{h.value=window.innerHeight},200);return Fe(async()=>{await Promise.all([_(),w()]),m.value=!0,window.addEventListener("resize",le)}),He(()=>{window.removeEventListener("resize",le)}),(a,s)=>{const C=ye;return t(i).gameVersion.local!==0?(v(),ie(ee,{key:0},[t(i).room.name===""?(v(),f(C,{key:0,type:"error",title:t(n)("global.noRoomSelected.title"),"sub-title":t(n)("global.noRoomSelected.subTitle"),height:d()},null,8,["title","sub-title","height"])):(v(),f(lt,{key:1,modelValue:t(o),"onUpdate:modelValue":s[1]||(s[1]=Q=>se(o)?o.value=Q:null)},{default:u(()=>[l(ge,null,{default:u(()=>[l(N,{color:t(o)>0?"success":"",complete:t(o)>0,value:0,title:t(n)("game.header.step1")},{icon:u(()=>[l(E,{icon:"ri-number-1",size:"12"})]),_:1},8,["color","complete","title"]),l(H),l(N,{color:t(o)>1?"success":"",complete:t(o)>1,value:1,title:t(n)("game.header.step2")},{icon:u(()=>[l(E,{icon:"ri-number-2",size:"12"})]),_:1},8,["color","complete","title"]),l(H),l(N,{color:t(o)>2?"success":"",complete:t(o)>2,value:2,title:t(n)("game.header.step3")},{icon:u(()=>[l(E,{icon:"ri-number-3",size:"12"})]),_:1},8,["color","complete","title"]),l(H),l(N,{color:t(o)>3?"success":"",complete:t(o)>3,value:3,title:t(n)("game.header.step4")},{icon:u(()=>[l(E,{icon:"ri-number-4",size:"12"})]),_:1},8,["color","complete","title"]),l(H),l(N,{color:t(o)>4?"success":"",complete:t(o)>4,value:4,title:t(n)("game.header.step5")},{icon:u(()=>[l(E,{icon:"ri-number-5",size:"12"})]),_:1},8,["color","complete","title"])]),_:1}),l(be,{modelValue:t(o),"onUpdate:modelValue":s[0]||(s[0]=Q=>se(o)?o.value=Q:null),class:"mt-4"},{default:u(()=>[l(W,{value:0},{default:u(()=>[t(m)&&t(o)===0?(v(),f(K,{key:0,height:d(),style:{"overflow-y":"auto"}},{default:u(()=>[l(Me,{ref_key:"roomRef",ref:D,"room-count":t(g),"max-players":t(r).userInfo.role==="admin"?0:t(r).userInfo.maxPlayers,"form-data":t(S)},null,8,["room-count","max-players","form-data"])]),_:1},8,["height"])):(v(),f(C,{key:1,type:"info",title:t(n)("game.base.loading"),height:d()},null,8,["title","height"]))]),_:1}),l(W,{value:1},{default:u(()=>[t(m)&&t(o)===1?(v(),f(K,{key:0,height:d(),style:{"overflow-y":"auto"}},{default:u(()=>[l(je,{ref_key:"worldRef",ref:A,"world-count":t(y),"form-data":t(x),"game-mode":t(S).gameMode,"max-worlds":t(r).userInfo.role==="admin"?0:t(r).userInfo.maxWorlds,theme:t(i).theme,"tab-window-height":d()-300},null,8,["world-count","form-data","game-mode","max-worlds","theme","tab-window-height"])]),_:1},8,["height"])):(v(),f(C,{key:1,type:"info",title:t(n)("game.base.loading"),height:d()},null,8,["title","height"]))]),_:1}),l(W,{value:2},{default:u(()=>[t(m)&&t(o)===2?(v(),f(K,{key:0,height:d(),style:{"overflow-y":"auto"}},{default:u(()=>[l(Ue,{ref_key:"modRef",ref:G,worlds:t(x),mod:t(S).modData,"mod-in-one":t(S).modInOne,theme:t(i).theme,"tab-window-height":d()-110},null,8,["worlds","mod","mod-in-one","theme","tab-window-height"])]),_:1},8,["height"])):(v(),f(C,{key:1,type:"info",title:t(n)("game.base.loading"),height:d()},null,8,["title","height"]))]),_:1}),l(W,{value:3},{default:u(()=>[t(m)&&t(o)===3?(v(),f(K,{key:0,height:d(),style:{"overflow-y":"auto"}},{default:u(()=>[l(qe,{ref_key:"roomSettingRef",ref:T,"room-setting":t(c)},null,8,["room-setting"])]),_:1},8,["height"])):(v(),f(C,{key:1,type:"info",title:t(n)("game.base.loading"),height:d()},null,8,["title","height"]))]),_:1}),l(W,{value:4},{default:u(()=>[t(o)===4?(v(),f(C,{key:0,type:"success",height:d(),title:t(n)("game.base.step5.title"),"sub-title":t(n)("game.base.step5.subTitle")},null,8,["height","title","sub-title"])):Z("",!0)]),_:1})]),_:1},8,["modelValue"]),l(fe,{class:"mx-8"},{prev:u(()=>[l(O,{disabled:t(o)===0,color:"grey-lighten-3",variant:"elevated",onClick:P},{default:u(()=>[j(U(t(n)("game.prev")),1)]),_:1},8,["disabled"])]),next:u(()=>[t(o)!==4?(v(),f(O,{key:0,color:"primary",variant:"elevated",onClick:$},{default:u(()=>[j(U(t(n)("game.next.button")),1)]),_:1})):Z("",!0),t(o)===4?(v(),f(O,{key:1,color:"success",disabled:!1,loading:t(V),variant:"elevated",onClick:he},{default:u(()=>[j(U(t(n)("game.next.save")),1)]),_:1},8,["loading"])):Z("",!0)]),_:1})]),_:1},8,["modelValue"]))],64)):(v(),ie(ee,{key:1},[t(r).userInfo.role==="admin"?(v(),f(C,{key:0,title:t(n)("global.noGame.title"),"sub-title":t(n)("global.noGame.subTitle"),height:d(),type:"error"},{default:u(()=>[l(O,{to:"/install",class:"mt-4"},{default:u(()=>[j(U(t(n)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(v(),f(C,{key:1,title:t(n)("global.noGameNoAdmin.title"),"sub-title":t(n)("global.noGameNoAdmin.subTitle"),height:d(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{$t as default};
