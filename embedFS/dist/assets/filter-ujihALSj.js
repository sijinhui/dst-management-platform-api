import{aj as O,a6 as w,i as j,l as g,bQ as x,b_ as I,aw as L}from"./index-D0_VvR3J.js";const v=(e,t,n)=>{if(e==null||t==null)return-1;if(!t.length)return 0;e=e.toString().toLocaleLowerCase(),t=t.toString().toLocaleLowerCase();const l=[];let o=e.indexOf(t);for(;~o;)l.push([o,o+t.length]),o=e.indexOf(t,o+t.length);return l.length?l:-1};function p(e,t){if(!(e==null||typeof e=="boolean"||e===-1))return typeof e=="number"?[[e,e+t.length]]:Array.isArray(e[0])?e:[e]}const _=O({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function A(e,t,n){const l=[],o=n?.default??v,u=n?.filterKeys?I(n.filterKeys):!1,c=Object.keys(n?.customKeyFilter??{}).length;if(!e?.length)return l;let f=null;e:for(let r=0;r<e.length;r++){const[s,F=s]=I(e[r]),d={},a={};let i=-1;if((t||c>0)&&!n?.noFilter){let M=!1;if(typeof s=="object"){if(s.type==="divider"||s.type==="subheader"){f?.type==="divider"&&s.type==="subheader"&&l.push(f),f={index:r,matches:{},type:s.type};continue}const m=u||Object.keys(F);M=m.length===c;for(const b of m){const k=L(F,b),K=n?.customKeyFilter?.[b];if(i=K?K(k,t,s):o(k,t,s),i!==-1&&i!==!1)K?d[b]=p(i,t):a[b]=p(i,t);else if(n?.filterMode==="every")continue e}}else i=o(s,t,s),i!==-1&&i!==!1&&(a.title=p(i,t));const h=Object.keys(a).length,y=Object.keys(d).length;if(!h&&!y||n?.filterMode==="union"&&y!==c&&!h||n?.filterMode==="intersection"&&(y!==c||!h&&c>0&&!M))continue}f&&(l.push(f),f=null),l.push({index:r,matches:{...a,...d}})}return l}function C(e,t,n,l){const o=w([]),u=w(new Map),c=j(()=>l?.transform?g(t).map(r=>[r,l.transform(r)]):g(t));x(()=>{const r=typeof n=="function"?n():g(n),s=typeof r!="string"&&typeof r!="number"?"":String(r),F=A(c.value,s,{customKeyFilter:{...e.customKeyFilter,...g(l?.customKeyFilter)},default:e.customFilter,filterKeys:e.filterKeys,filterMode:e.filterMode,noFilter:e.noFilter}),d=g(t),a=[],i=new Map;F.forEach(M=>{let{index:h,matches:y}=M;const m=d[h];a.push(m),i.set(m.value,y)}),o.value=a,u.value=i});function f(r){return u.value.get(r.value)}return{filteredItems:o,filteredMatches:u,getMatches:f}}export{_ as m,C as u};
