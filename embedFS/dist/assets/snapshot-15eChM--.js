import{_ as R}from"./Result-gWT-ossO.js";import{_ as $}from"./ConfirmBox-qQUgNQN6.js";import{t as z}from"./tools-B2389Z04.js";import{g as A,d as H,e as M,b as U,f as i,j as q,a8 as P,a9 as j,c as b,l as e,o as r,A as V,F as k,a,w as o,k as u,t as l,J as D,x as G,s as h,v as m,cB as J,ae as K,D as O,ad as Q,G as W}from"./index-D0_VvR3J.js";import{a as X,V as Y}from"./VExpansionPanels-ZI2HIFnX.js";import{V as Z}from"./VDataTable-DH4Ujgw6.js";import{V as w}from"./VChip-Bl_XNOgC.js";import{V as ee,a as te}from"./VToolbar-BJcGoYLB.js";import{V as oe}from"./VSkeletonLoader-DlxWhbhq.js";import"./VContainer-BdgJJao2.js";/* empty css              */import"./VAlert-Cnu_GEOX.js";import"./VSpacer-BWidqFwK.js";import"./VDialog-laDXRq-G.js";import"./dialog-transition-Bnn_UDo8.js";import"./axios-B3QxYxjQ.js";import"./index-BYTG7FXw.js";import"./VPagination-_V6tKqvs.js";import"./VSelect-DehtkG2o.js";import"./VInput-CQ0d1937.js";import"./VTextField-BDhl3HoB.js";import"./VList-B7_QlUC1.js";import"./ssrBoot-CVvmSRtT.js";import"./VMenu-gAht7neB.js";import"./VCheckboxBtn-DD1lUkrO.js";import"./VSelectionControl-KRPi77qu.js";import"./VTable-CvulZgfR.js";import"./filter-ujihALSj.js";const ae={class:"mb-2"},le={class:"mb-2"},ne={class:"mb-2"},se={class:"mb-2 text-error"},ie={key:0},$e={__name:"snapshot",setup(re){const c=A(),N=H(),{mobile:E}=M(),{t}=U(),S=i(window.innerHeight),T=i([]),f=i(!1),g=()=>{if(c.room.id===0)return;f.value=!0;const p={roomID:c.room.id};z.snapshot.get(p).then(s=>{T.value=s.data||[]}).finally(()=>{f.value=!1})},_=i([{key:"name",order:"desc"}]),F=[{key:"name",title:t("tools.snapshot.table.header.name")},{key:"size",title:t("tools.snapshot.table.header.size")},{key:"modTime",title:t("tools.snapshot.table.header.modTime")},{key:"actions",title:t("tools.snapshot.table.header.actions")}],d=i(!1),y=i(!1),B=i(""),I=()=>{y.value=!0;const p={roomID:c.room.id,name:B.value};z.snapshot.delete(p).then(s=>{W(s.message),d.value=!1,g()}).finally(()=>{y.value=!1})},C=P(()=>{S.value=window.innerHeight},200),v=()=>Math.max(2,Math.floor(S.value-150));return q(()=>{g(),window.addEventListener("resize",C)}),j(()=>{window.removeEventListener("resize",C)}),(p,s)=>{const L=$,x=R;return e(c).gameVersion.local!==0?(r(),b(k,{key:0},[e(c).room.id!==0?(r(),b(k,{key:0},[a(Y,null,{default:o(()=>[a(X,null,{title:o(()=>[a(D,{icon:"ri-information-line",start:""}),u("span",null,l(e(t)("tools.snapshot.expansion.title")),1)]),text:o(()=>[u("div",ae,l(e(t)("tools.snapshot.expansion.text1")),1),u("div",le,l(e(t)("tools.snapshot.expansion.text2")),1),u("div",ne,l(e(t)("tools.snapshot.expansion.text3")),1),u("div",se,l(e(t)("tools.snapshot.expansion.text4")),1)]),_:1})]),_:1}),a(Q,{border:"",rounded:"",class:"mt-4"},{default:o(()=>[a(Z,{"sort-by":e(_),"onUpdate:sortBy":s[0]||(s[0]=n=>G(_)?_.value=n:null),headers:F,items:e(T),loading:e(f)},{loading:o(()=>[a(oe,{type:"table-row@10"})]),top:o(()=>[a(ee,{flat:""},{default:o(()=>[a(te,null,{default:o(()=>[a(D,{icon:"ri-flip-horizontal-line",start:""}),e(E)?O("",!0):(r(),b("span",ie,l(e(t)("tools.snapshot.title")),1))]),_:1}),a(h,{"prepend-icon":"ri-refresh-line",loading:e(f),color:"default",onClick:g},{default:o(()=>[m(l(e(t)("platform.user.table.refresh")),1)]),_:1},8,["loading"])]),_:1})]),"item.name":o(({value:n})=>[a(w,{label:"",color:"info"},{default:o(()=>[m(l(n),1)]),_:2},1024)]),"item.size":o(({value:n})=>[a(w,{label:"",color:"default"},{default:o(()=>[m(l(e(K)(n)),1)]),_:2},1024)]),"item.modTime":o(({value:n})=>[a(w,{label:"",color:"primary"},{default:o(()=>[m(l(e(J)(n)),1)]),_:2},1024)]),"item.actions":o(({item:n})=>[a(h,{variant:"text",color:"error","prepend-icon":"ri-delete-bin-line",onClick:me=>{B.value=n.name,d.value=!0}},{default:o(()=>[m(l(e(t)("tools.snapshot.table.delete")),1)]),_:1},8,["onClick"])]),_:1},8,["sort-by","items","loading"])]),_:1}),a(L,{modelValue:e(d),"onUpdate:modelValue":s[1]||(s[1]=n=>G(d)?d.value=n:null),type:"warning",title:e(t)("global.confirm.title"),content:e(t)("global.confirm.content"),"confirm-text":e(t)("global.confirm.confirm"),"cancel-text":e(t)("global.confirm.cancel"),"confirm-loading":e(y),onConfirm:I,onCancel:s[2]||(s[2]=n=>d.value=!1)},null,8,["modelValue","title","content","confirm-text","cancel-text","confirm-loading"])],64)):(r(),V(x,{key:1,title:e(t)("global.noRoomSelected.title"),"sub-title":e(t)("global.noRoomSelected.subTitle"),type:"error",height:v()},{default:o(()=>[a(h,{to:"/rooms",class:"mt-4"},{default:o(()=>[m(l(e(t)("global.noRoomSelected.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"]))],64)):(r(),b(k,{key:1},[e(N).userInfo.role==="admin"?(r(),V(x,{key:0,title:e(t)("global.noGame.title"),"sub-title":e(t)("global.noGame.subTitle"),height:v(),type:"error"},{default:o(()=>[a(h,{to:"/install",class:"mt-4"},{default:o(()=>[m(l(e(t)("global.noGame.button")),1)]),_:1})]),_:1},8,["title","sub-title","height"])):(r(),V(x,{key:1,title:e(t)("global.noGameNoAdmin.title"),"sub-title":e(t)("global.noGameNoAdmin.subTitle"),height:v(),type:"error"},null,8,["title","sub-title","height"]))],64))}}};export{$e as default};
